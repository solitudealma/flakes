# dns.dae
dns {
  # 若 ipversion_prefer 设为 4，且域名同时有 A 和 AAAA 记录，dae 只回应 A 类型的请求，并返回空回复给 AAAA 请求。
  ipversion_prefer: 4
  upstream {
      # 阿里云 DNS，用于国内域名查询
      alidns: 'udp://223.5.5.5:53'
      # Cloudflare DNS，用于非国内的 DNS 查询
      cfdns: 'tcp+udp://1.1.1.1:53'
    }

    routing {
        request {
            # 内置出站:asis,reject
            # 可用的方法qname, qtype
            # 广告拒绝
            qname(geosite:category-ads-all) -> reject
            # 这里的意思是google中是cn的域名使用alidns
            qname(geosite:google@cn) -> alidns
            # 匹配后缀，匹配关键字
            qname(suffix: abc.com, keyword: google) -> cfdns
            # 全匹配和正则匹配
            qname(full: ok.com, regex: '^yes') -> cfdns
            # DNS 请求类型
            # ipv4和ipv6请求使用alidns
            qtype(a, aaaa) -> alidns
            # cname请求cfdns
            qtype(cname) -> cfdns
            # 默认DNS服务器
	        fallback: alidns
        }
        response {
            upstream(cfdns) -> accept
            !qname(geosite:cn) && ip(geoip:private) -> cfdns
            fallback: accept
        }
    }
}
